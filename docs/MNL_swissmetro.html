---

title: MNL with Swissmetro dataset

keywords: fastai
sidebar: home_sidebar

summary: "API details of MNL with Swissmetro dataset."
description: "API details of MNL with Swissmetro dataset."
nb_path: "02_MNL_swissmetro.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_MNL_swissmetro.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Data-preparation">Data preparation<a class="anchor-link" href="#Data-preparation"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/swissmetro.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;	&#39;</span><span class="p">)</span>
<span class="c1"># Remove unknown age (6)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">]</span>
<span class="c1"># Remove &quot;other&quot; trip purpose (9)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;PURPOSE&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">]</span>
<span class="c1"># Remove &quot;unknown&quot; choice (0)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CHOICE&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10692, 28)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;./data/swissmetro_clean.pkl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Data-loading">Data loading<a class="anchor-link" href="#Data-loading"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./data/swissmetro_clean.pkl&#39;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GROUP</th>
      <th>SURVEY</th>
      <th>SP</th>
      <th>ID</th>
      <th>PURPOSE</th>
      <th>FIRST</th>
      <th>TICKET</th>
      <th>WHO</th>
      <th>LUGGAGE</th>
      <th>AGE</th>
      <th>...</th>
      <th>TRAIN_TT</th>
      <th>TRAIN_CO</th>
      <th>TRAIN_HE</th>
      <th>SM_TT</th>
      <th>SM_CO</th>
      <th>SM_HE</th>
      <th>SM_SEATS</th>
      <th>CAR_TT</th>
      <th>CAR_CO</th>
      <th>CHOICE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>112</td>
      <td>48</td>
      <td>120</td>
      <td>63</td>
      <td>52</td>
      <td>20</td>
      <td>0</td>
      <td>117</td>
      <td>65</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>103</td>
      <td>48</td>
      <td>30</td>
      <td>60</td>
      <td>49</td>
      <td>10</td>
      <td>0</td>
      <td>117</td>
      <td>84</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>130</td>
      <td>48</td>
      <td>60</td>
      <td>67</td>
      <td>58</td>
      <td>30</td>
      <td>0</td>
      <td>117</td>
      <td>52</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>103</td>
      <td>40</td>
      <td>30</td>
      <td>63</td>
      <td>52</td>
      <td>20</td>
      <td>0</td>
      <td>72</td>
      <td>52</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>...</td>
      <td>130</td>
      <td>36</td>
      <td>60</td>
      <td>63</td>
      <td>42</td>
      <td>20</td>
      <td>0</td>
      <td>90</td>
      <td>84</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 28 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Biogeme">Biogeme<a class="anchor-link" href="#Biogeme"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># df = pd.read_csv(&#39;swissmetro.dat&#39;, &#39;\t&#39;)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./data/swissmetro_clean.pkl&#39;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
<span class="n">database</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;swissmetro&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(10692, 28)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># as Python variable.</span>
<span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># exclude = ((PURPOSE != 1) * (PURPOSE != 3) + (CHOICE == 0)) &gt; 0</span>
<span class="c1"># database.remove(exclude)</span>

<span class="c1"># Parameters to be estimated</span>
<span class="n">ASC_CAR</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;ASC_CAR&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ASC_TRAIN</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;ASC_TRAIN&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ASC_SM</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;ASC_SM&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">B_TIME</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;B_TIME&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">B_COST</span> <span class="o">=</span> <span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;B_COST&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SM_COST</span> <span class="o">=</span> <span class="n">SM_CO</span> <span class="o">*</span> <span class="p">(</span><span class="n">GA</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">TRAIN_COST</span> <span class="o">=</span> <span class="n">TRAIN_CO</span> <span class="o">*</span> <span class="p">(</span><span class="n">GA</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">CAR_AV_SP</span> <span class="o">=</span> <span class="n">CAR_AV</span> <span class="o">*</span> <span class="p">(</span><span class="n">SP</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">TRAIN_AV_SP</span> <span class="o">=</span> <span class="n">TRAIN_AV</span> <span class="o">*</span> <span class="p">(</span><span class="n">SP</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">TRAIN_TT_SCALED</span> <span class="o">=</span> <span class="n">TRAIN_TT</span> <span class="o">/</span> <span class="mf">100.0</span>
<span class="n">TRAIN_COST_SCALED</span> <span class="o">=</span> <span class="n">TRAIN_COST</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">SM_TT_SCALED</span> <span class="o">=</span> <span class="n">SM_TT</span> <span class="o">/</span> <span class="mf">100.0</span>
<span class="n">SM_COST_SCALED</span> <span class="o">=</span> <span class="n">SM_COST</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">CAR_TT_SCALED</span> <span class="o">=</span> <span class="n">CAR_TT</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">CAR_CO_SCALED</span> <span class="o">=</span> <span class="n">CAR_CO</span> <span class="o">/</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">V1</span> <span class="o">=</span> <span class="n">ASC_TRAIN</span> <span class="o">+</span> \
     <span class="n">B_TIME</span> <span class="o">*</span> <span class="n">TRAIN_TT_SCALED</span> <span class="o">+</span> \
     <span class="n">B_COST</span> <span class="o">*</span> <span class="n">TRAIN_COST_SCALED</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">ASC_SM</span> <span class="o">+</span> \
     <span class="n">B_TIME</span> <span class="o">*</span> <span class="n">SM_TT_SCALED</span> <span class="o">+</span> \
     <span class="n">B_COST</span> <span class="o">*</span> <span class="n">SM_COST_SCALED</span>
<span class="n">V3</span> <span class="o">=</span> <span class="n">ASC_CAR</span> <span class="o">+</span> \
     <span class="n">B_TIME</span> <span class="o">*</span> <span class="n">CAR_TT_SCALED</span> <span class="o">+</span> \
     <span class="n">B_COST</span> <span class="o">*</span> <span class="n">CAR_CO_SCALED</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">V</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="n">V1</span><span class="p">,</span>
     <span class="mi">2</span><span class="p">:</span> <span class="n">V2</span><span class="p">,</span>
     <span class="mi">3</span><span class="p">:</span> <span class="n">V3</span><span class="p">}</span>

<span class="c1"># Associate the availability conditions with the alternatives</span>
<span class="n">av</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="n">TRAIN_AV_SP</span><span class="p">,</span>
      <span class="mi">2</span><span class="p">:</span> <span class="n">SM_AV</span><span class="p">,</span>
      <span class="mi">3</span><span class="p">:</span> <span class="n">CAR_AV_SP</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># observation to the log likelihood function.</span>
<span class="n">logprob</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">loglogit</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">av</span><span class="p">,</span> <span class="n">CHOICE</span><span class="p">)</span>

<span class="c1"># Create the Biogeme object</span>
<span class="n">biogeme</span> <span class="o">=</span> <span class="n">bio</span><span class="o">.</span><span class="n">BIOGEME</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">logprob</span><span class="p">)</span>
<span class="c1"># biogeme.modelName = &#39;01logit&#39;</span>
<span class="n">biogeme</span><span class="o">.</span><span class="n">modelName</span> <span class="o">=</span> <span class="s1">&#39;anything&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">biogeme</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>

<span class="c1"># Get the results in a pandas table</span>
<span class="n">pandasResults</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">getEstimatedParameters</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pandasResults</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>              Value   Std err     t-test   p-value  Rob. Std err  Rob. t-test  \
ASC_CAR    0.016930  0.031410   0.538992  0.589892      0.037120     0.456079   
ASC_TRAIN -0.656391  0.041921 -15.657964  0.000000      0.054510   -12.041692   
B_COST    -0.789108  0.036321 -21.725702  0.000000      0.050931   -15.493548   
B_TIME    -1.277293  0.042630 -29.962201  0.000000      0.065605   -19.469462   

           Rob. p-value  
ASC_CAR        0.648333  
ASC_TRAIN      0.000000  
B_COST         0.000000  
B_TIME         0.000000  
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pandasResults</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>ASC_CAR      0.016930
ASC_TRAIN   -0.656391
B_COST      -0.789108
B_TIME      -1.277293
Name: Value, dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pandasResults</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;ASC_CAR&#39;</span><span class="p">,</span><span class="s1">&#39;Value&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.01692988840776121</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># of about the same size, randomly defined. Each slice is considered</span>
<span class="c1"># as a validation dataset. The model is then re-estimated using all</span>
<span class="c1"># the data except the slice, and the estimated model is applied on the</span>
<span class="c1"># validation set (i.e. the slice). The value of the log likelihood for</span>
<span class="c1"># each observation in the validation set is reported in a</span>
<span class="c1"># dataframe. As this is done for each slice, the output is a list of</span>
<span class="c1"># dataframes, each corresponding to one of these exercises.</span>

<span class="n">validation_results</span> <span class="o">=</span> <span class="n">biogeme</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">results</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">slide</span> <span class="ow">in</span> <span class="n">validation_results</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Log likelihood for </span><span class="si">{</span><span class="n">slide</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> validation data: </span><span class="si">{</span><span class="n">slide</span><span class="p">[</span><span class="s2">&quot;Loglikelihood&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Log likelihood for 2139 validation data: -1725.6245127576863
Log likelihood for 2139 validation data: -1757.9792027381814
Log likelihood for 2138 validation data: -1708.3622443500494
Log likelihood for 2138 validation data: -1739.8047807640314
Log likelihood for 2138 validation data: -1716.1084410042763
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slices</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">validationData</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">validationData</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>zip</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">validationData</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;tuple&#39;&gt;
&lt;class &#39;tuple&#39;&gt;
&lt;class &#39;tuple&#39;&gt;
&lt;class &#39;tuple&#39;&gt;
&lt;class &#39;tuple&#39;&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tuple, 2)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(pandas.core.frame.DataFrame,
 pandas.core.frame.DataFrame,
 (8554, 28),
 (2138, 28))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">1711</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1710</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>8554</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">6844</span> <span class="o">+</span> <span class="mi">1710</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>8554</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">keepDatabase</span> <span class="o">=</span> <span class="n">database</span>
<span class="nb">type</span><span class="p">(</span><span class="n">keepDatabase</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>biogeme.database.Database</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">estimationResults</span> <span class="o">=</span> <span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">allSimulationResults</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">validationData</span><span class="p">:</span>
    <span class="c1"># v[0] is the estimation data set</span>
    <span class="n">database</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Database</span><span class="p">(</span><span class="s1">&#39;Estimation data&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">biogeme</span><span class="o">.</span><span class="n">loglike</span><span class="o">.</span><span class="n">changeInitValues</span><span class="p">(</span><span class="n">estimationResults</span><span class="o">.</span><span class="n">getBetaValues</span><span class="p">())</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">biogeme</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
    <span class="n">simulate</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Loglikelihood&#39;</span><span class="p">:</span> <span class="n">biogeme</span><span class="o">.</span><span class="n">loglike</span><span class="p">}</span>
<span class="c1">#     simBiogeme = BIOGEME(db.Database(&#39;Validation data&#39;, v[1]),</span>
<span class="c1">#                          simulate)</span>
<span class="c1">#     simResult = simBiogeme.simulate(results.getBetaValues())</span>
    <span class="n">simResult</span> <span class="o">=</span> <span class="n">biogeme</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">getBetaValues</span><span class="p">())</span>
    <span class="n">allSimulationResults</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simResult</span><span class="p">)</span>
<span class="n">biogeme</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">keepDatabase</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">allSimulationResults</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">slide</span><span class="p">),</span> <span class="n">slide</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(pandas.core.frame.DataFrame, (2138, 1))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;biogeme.results.bioResults at 0x7f6feceff1f0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="PyLogit">PyLogit<a class="anchor-link" href="#PyLogit"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

