---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "01_pylogit_mnl_complex.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_pylogit_mnl_complex.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pylogit</span> <span class="k">as</span> <span class="nn">pl</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-Swiss-metro-data">Load Swiss metro data<a class="anchor-link" href="#Load-Swiss-metro-data"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sm_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/swissmetro_long.csv&quot;</span><span class="p">)</span>
<span class="n">sm_long</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(19143, 22)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-the-model-specification">Create the model specification<a class="anchor-link" href="#Create-the-model-specification"> </a></h3><p>The model specification being used in this example is the following:
$$
\begin{aligned}
V_{i, \textrm{Train}} &amp;= \textrm{ASC Train} + \\
&amp;\quad \beta _{ \textrm{tt_transit} } \textrm{Travel Time} _{ \textrm{Train}} * \frac{1}{60} + \\
&amp;\quad \beta _{ \textrm{tc_train} } \textrm{Travel Cost}_{\textrm{Train}} * \left( GA == 0 \right) * 0.01 + \\
&amp;\quad \beta _{ \textrm{headway_train} } \textrm{Headway} _{\textrm{Train}} * \frac{1}{60} + \\
&amp;\quad \beta _{ \textrm{survey} } \left( \textrm{Train Survey} == 1 \right) \\
\\
V_{i, \textrm{Swissmetro}} &amp;= \textrm{ASC Swissmetro} + \\
&amp;\quad \beta _{ \textrm{tt_transit} } \textrm{Travel Time} _{ \textrm{Swissmetro}} * \frac{1}{60} + \\
&amp;\quad \beta _{ \textrm{tc_sm} } \textrm{Travel Cost}_{\textrm{Swissmetro}} * \left( GA == 0 \right) * 0.01 + \\
&amp;\quad \beta _{ \textrm{headway_sm} } \textrm{Heaway} _{\textrm{Swissmetro}} * \frac{1}{60} + \\
&amp;\quad \beta _{ \textrm{seat} } \left( \textrm{Seat Configuration} == 1 \right) \\
&amp;\quad \beta _{ \textrm{survey} } \left( \textrm{Train Survey} == 1 \right) \\
&amp;\quad \beta _{ \textrm{first_class} } \left( \textrm{First Class} == 0 \right) \\
\\
V_{i, \textrm{Car}} &amp;= \beta _{ \textrm{tt_car} } \textrm{Travel Time} _{ \textrm{Car}} * \frac{1}{60} + \\
&amp;\quad \beta _{ \textrm{tc_car}} \textrm{Travel Cost}_{\textrm{Car}} * 0.01 + \\
&amp;\quad \beta _{\textrm{luggage}=1} \left( \textrm{Luggage} == 1 \right) + \\
&amp;\quad \beta _{\textrm{luggage}&gt;1} \left( \textrm{Luggage} &gt; 1 \right)
\end{aligned}
$$</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;travel_time_hrs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;travel_time&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">60.0</span>
<span class="c1"># Scale the headway column by 60 to convert raw units (minutes) to hours</span>
<span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;headway_hrs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;headway&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">60.0</span>
<span class="c1"># Get free_ticket</span>
<span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;free_ticket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;GA&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;WHO&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))</span> <span class="o">&amp;</span>
                            <span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;mode_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="c1"># Scale travel cost to 100.0</span>
<span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;travel_cost_hundreth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;travel_cost&quot;</span><span class="p">]</span> <span class="o">*</span>
                                  <span class="p">(</span><span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;free_ticket&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">)</span>
<span class="c1"># Create a dummy variable for whether a person has a single piece of luggage</span>
<span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;single_luggage_piece&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;LUGGAGE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="c1"># Create a dummy variable for whether a person has multiple pieces of luggage</span>
<span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;multiple_luggage_pieces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;LUGGAGE&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="c1"># Create a dummy variable indicating that a person is NOT first class</span>
<span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;regular_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;FIRST&quot;</span><span class="p">]</span>
<span class="c1"># Create a dummy variable indicating that the survey was taken aboard a train</span>
<span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;train_survey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sm_long</span><span class="p">[</span><span class="s2">&quot;SURVEY&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">specification</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;intercept&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;travel_time_hrs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,],</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;travel_cost_hundreth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;headway_hrs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;seat_configuration&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;train_survey&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;regular_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;single_luggage_piece&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">specification</span><span class="p">[</span><span class="s2">&quot;multiple_luggage_pieces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">swissmetro_mnl</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">create_choice_model</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sm_long</span><span class="p">,</span>
                                        <span class="n">alt_id_col</span><span class="o">=</span><span class="s2">&quot;mode_id&quot;</span><span class="p">,</span>
                                        <span class="n">obs_id_col</span><span class="o">=</span><span class="s2">&quot;custom_id&quot;</span><span class="p">,</span>
                                        <span class="n">choice_col</span><span class="o">=</span><span class="s2">&quot;CHOICE&quot;</span><span class="p">,</span>
                                        <span class="n">specification</span><span class="o">=</span><span class="n">specification</span><span class="p">,</span>
                                        <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;MNL&quot;</span><span class="p">)</span>

<span class="c1"># Specify the initial values and method for the optimization.</span>
<span class="n">swissmetro_mnl</span><span class="o">.</span><span class="n">fit_mle</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>

<span class="c1"># Look at the estimation results</span>
<span class="n">swissmetro_mnl</span><span class="o">.</span><span class="n">get_statsmodels_summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Log-likelihood at zero: -6,964.6630
Initial Log-likelihood: -6,964.6630
Estimation Time for Point Estimation: 0.06 seconds.
Final log-likelihood: -5,159.2583
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/danph/anaconda3/envs/ml-dchoice/lib/python3.7/site-packages/scipy/optimize/_minimize.py:523: RuntimeWarning: Method BFGS does not use Hessian information (hess).
  RuntimeWarning)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<table class="simpletable">
<caption>Multinomial Logit Model Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>CHOICE</td>          <th>  No. Observations:  </th>    <td>6,768</td>  
</tr>
<tr>
  <th>Model:</th>         <td>Multinomial Logit Model</td> <th>  Df Residuals:      </th>    <td>6,754</td>  
</tr>
<tr>
  <th>Method:</th>                  <td>MLE</td>           <th>  Df Model:          </th>     <td>14</td>    
</tr>
<tr>
  <th>Date:</th>             <td>Thu, 11 Mar 2021</td>     <th>  Pseudo R-squ.:     </th>    <td>0.259</td>  
</tr>
<tr>
  <th>Time:</th>                 <td>15:13:59</td>         <th>  Pseudo R-bar-squ.: </th>    <td>0.257</td>  
</tr>
<tr>
  <th>AIC:</th>                 <td>10,346.517</td>        <th>  Log-Likelihood:    </th> <td>-5,159.258</td>
</tr>
<tr>
  <th>BIC:</th>                 <td>10,441.996</td>        <th>  LL-Null:           </th> <td>-6,964.663</td>
</tr>
</table>
<table class="simpletable">
<tr>
              <td></td>                 <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>intercept_1</th>               <td>   -1.2929</td> <td>    0.146</td> <td>   -8.845</td> <td> 0.000</td> <td>   -1.579</td> <td>   -1.006</td>
</tr>
<tr>
  <th>intercept_2</th>               <td>   -0.5026</td> <td>    0.116</td> <td>   -4.332</td> <td> 0.000</td> <td>   -0.730</td> <td>   -0.275</td>
</tr>
<tr>
  <th>travel_time_hrs_[1, 2]</th>    <td>   -0.6990</td> <td>    0.042</td> <td>  -16.545</td> <td> 0.000</td> <td>   -0.782</td> <td>   -0.616</td>
</tr>
<tr>
  <th>travel_time_hrs_3</th>         <td>   -0.7230</td> <td>    0.047</td> <td>  -15.340</td> <td> 0.000</td> <td>   -0.815</td> <td>   -0.631</td>
</tr>
<tr>
  <th>travel_cost_hundreth_1</th>    <td>   -0.5618</td> <td>    0.094</td> <td>   -6.002</td> <td> 0.000</td> <td>   -0.745</td> <td>   -0.378</td>
</tr>
<tr>
  <th>travel_cost_hundreth_2</th>    <td>   -0.2817</td> <td>    0.045</td> <td>   -6.252</td> <td> 0.000</td> <td>   -0.370</td> <td>   -0.193</td>
</tr>
<tr>
  <th>travel_cost_hundreth_3</th>    <td>   -0.5139</td> <td>    0.104</td> <td>   -4.953</td> <td> 0.000</td> <td>   -0.717</td> <td>   -0.311</td>
</tr>
<tr>
  <th>headway_hrs_1</th>             <td>   -0.3143</td> <td>    0.062</td> <td>   -5.063</td> <td> 0.000</td> <td>   -0.436</td> <td>   -0.193</td>
</tr>
<tr>
  <th>headway_hrs_2</th>             <td>   -0.3773</td> <td>    0.196</td> <td>   -1.925</td> <td> 0.054</td> <td>   -0.761</td> <td>    0.007</td>
</tr>
<tr>
  <th>seat_configuration_2</th>      <td>   -0.7825</td> <td>    0.087</td> <td>   -8.970</td> <td> 0.000</td> <td>   -0.953</td> <td>   -0.611</td>
</tr>
<tr>
  <th>train_survey_[1, 2]</th>       <td>    2.5425</td> <td>    0.114</td> <td>   22.235</td> <td> 0.000</td> <td>    2.318</td> <td>    2.767</td>
</tr>
<tr>
  <th>regular_class_1</th>           <td>    0.5650</td> <td>    0.077</td> <td>    7.305</td> <td> 0.000</td> <td>    0.413</td> <td>    0.717</td>
</tr>
<tr>
  <th>single_luggage_piece_3</th>    <td>    0.4228</td> <td>    0.067</td> <td>    6.270</td> <td> 0.000</td> <td>    0.291</td> <td>    0.555</td>
</tr>
<tr>
  <th>multiple_luggage_pieces_3</th> <td>    1.4141</td> <td>    0.259</td> <td>    5.461</td> <td> 0.000</td> <td>    0.907</td> <td>    1.922</td>
</tr>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluation-metrics">Evaluation metrics<a class="anchor-link" href="#Evaluation-metrics"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">classification_report</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">model_pred</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">alt_id_col</span><span class="p">,</span> <span class="n">obs_id_col</span><span class="p">,</span> <span class="n">choice_col</span><span class="p">):</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  
    <span class="n">is_chosen</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">obs_id_col</span><span class="p">])[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted_choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">is_chosen</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="s1">&#39;predicted_choice&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="n">actual</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">choice_column</span><span class="p">]</span> <span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="n">alt_id_column</span><span class="p">]</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;predicted_choice&#39;</span><span class="p">]</span> <span class="o">==</span><span class="mi">1</span><span class="p">,</span><span class="n">alt_id_column</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">actual</span><span class="p">,</span> <span class="n">pred</span>   

<span class="k">def</span> <span class="nf">nll</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="n">alt_id_column</span> <span class="o">=</span> <span class="s2">&quot;mode_id&quot;</span>
<span class="n">obs_id_column</span> <span class="o">=</span> <span class="s2">&quot;custom_id&quot;</span>
<span class="n">choice_column</span> <span class="o">=</span> <span class="s2">&quot;CHOICE&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="MNL-model-results">MNL model results<a class="anchor-link" href="#MNL-model-results"> </a></h5>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">actual</span><span class="p">,</span> <span class="n">predict</span> <span class="o">=</span> <span class="n">model_pred</span><span class="p">(</span><span class="n">sm_long</span><span class="p">,</span> <span class="n">swissmetro_mnl</span><span class="p">,</span> <span class="n">alt_id_column</span><span class="p">,</span> <span class="n">obs_id_column</span><span class="p">,</span> <span class="n">choice_column</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">predict</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

           1       0.46      0.04      0.07       908
           2       0.67      0.86      0.76      4090
           3       0.60      0.50      0.54      1770

    accuracy                           0.65      6768
   macro avg       0.58      0.46      0.46      6768
weighted avg       0.63      0.65      0.61      6768

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">predict</span><span class="p">),</span> 
<span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">predict</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">, F1_score = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Accuracy = [0.65485], F1_score = 0.60754
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

